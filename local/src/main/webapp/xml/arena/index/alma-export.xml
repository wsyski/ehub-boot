<?xml version="1.0" encoding="UTF-8"?>
<config format="alma-export">
	<index>
        <field name="contentProviderName">
            <query type="xquery">let $contentProviderName:=//exportCatalogueRecord/@contentProviderName let $pattern:='(.+)(id_type=ISBN&amp;amp;id=)([0-9]+)(.*)' return if (not(empty($contentProviderName))) then string($contentProviderName) else for $link in //view/externalUrls/externalUrl/@value return if (matches($link,$pattern)) then 'elib' else null</query>
        </field>
        <field name="contentProviderRecordId">
            <query type="xquery">let $contentProviderRecordId:=//exportCatalogueRecord/@contentProviderRecordId let $pattern:='(.+)(id_type=ISBN&amp;amp;id=)([0-9]+)(.*)' return if (not(empty($contentProviderRecordId))) then string($contentProviderRecordId) else for $link in //view/externalUrls/externalUrl/@value return if (matches($link,$pattern)) then replace($link,$pattern,'$3') else null</query>
        </field>
	</index>
</config>